#!/usr/bin/env ruby

require 'terrestrial'
require 'optparse'

options = {}
OptionParser.new do |opts|
  opts.banner = "Usage: terrestrial <command> <options>"
  opts.separator  ""
  opts.separator  "Commands"
  opts.separator  "     init: Initialize your project with Terrestrial"
  opts.separator  ""
  opts.separator  "Options"

  opts.on("--api-key [string]", "Set and store api key") do |key|
    options[:api_key] = key
  end

  opts.on("--project-id [integer]", "Set the app's project id") do |id|
    options[:project_id] = id.to_i
  end

  opts.on_tail("--version", "Show version") do
    puts "Terrestrial CLI: #{Terrestrial::Cli::VERSION}"
    exit
  end
end.parse!

command = ARGV[0]

abort "Terrestrial CLI #{Terrestrial::Cli::VERSION}" if command.nil?
abort "Terrestrial: '#{command}' does not compute?" unless Terrestrial::Cli::COMMANDS.include? command

Terrestrial::Cli.start(command, options)
